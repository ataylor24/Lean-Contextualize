[{"value":{"range":[862,6041],"original":true},"type":{"range":[837,861],"original":true},"signature":{"range":[778,861],"pp":" {a b : ℝ} {f : ℝ → ℝ} (hf : MonotoneOn f (Icc a b)) : IntegrableOn f (Icc a b)","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[726,6041],"pp":"/-- Proposition 11.6.1 -/\ntheorem integ_of_monotone {a b : ℝ} {f : ℝ → ℝ} (hf : MonotoneOn f (Icc a b)) : IntegrableOn f (Icc a b) := by\n  -- This proof is adapted from the structure of the original text.\n  \n  by_cases hab : 0 < b - a\n  swap\n  . apply (integ_on_subsingleton _).1; rw [← BoundedInterval.length_of_subsingleton]; aesop\n  have hbound := BddOn.of_monotone hf\n  set I := Icc a b\n  have hab' : a ≤ b := by linarith\n  have (ε : ℝ) (hε : 0 < ε) : upper_integral f I - lower_integral f I ≤ ((f b - f a) * (b - a)) * ε :=\n    by\n    choose N hN using exists_nat_gt (1 / ε)\n    have hNpos : 0 < N := by rify; linarith [show 0 < 1 / ε by positivity]\n    set δ := (b - a) / N\n    have hδpos : 0 < δ := by positivity\n    have hbeq : b = a + δ * N := by simp [δ]; field_simp\n    set e : ℕ ↪ BoundedInterval :=\n      { toFun j := Ico (a + δ * j) (a + δ * (j + 1))\n        inj' j k hjk := by simp at hjk; obtain _ | _ := hjk <;> linarith }\n    set P : Partition I :=\n      { intervals := insert (Icc b b) (.map e (.range N))\n        exists_unique := by\n          intro x hx; simp; by_cases hb : x = b\n          . apply ExistsUnique.intro (Icc b b)\n            . simp [hb, mem_iff]\n            rintro J ⟨rfl | ⟨j, hA, rfl⟩, hJb⟩; rfl\n            simp [e, mem_iff, hb, hbeq] at hJb\n            replace hJb := hJb.2\n            rw [mul_lt_mul_iff_of_pos_left hδpos] at hJb\n            norm_cast at hJb; linarith\n          simp [I, mem_iff] at hx\n          set j := ⌊(x - a) / δ⌋₊\n          have hxa : 0 ≤ x - a := by linarith\n          have hxaδ : 0 ≤ (x - a) / δ := by positivity\n          have hxb : x < b := by grind\n          have hxj : x ∈ e j := by\n            simp [e, mem_iff, j]; split_ands\n            .\n              calc\n                _ ≤ a + δ * ((x - a) / δ) := by gcongr; grind [Nat.floor_le]\n                _ = x := by grind\n            calc\n              _ = a + δ * ((x - a) / δ) := by field_simp\n              _ < _ := by gcongr; apply Nat.lt_floor_add_one\n          apply ExistsUnique.intro (e j)\n          . refine ⟨?_, hxj⟩; right; use j; simp [j, Nat.floor_lt hxaδ, div_lt_iff₀' hδpos]; linarith\n          rintro J ⟨rfl | ⟨k, hk, rfl⟩, hxJ⟩\n          . simp [mem_iff] at hxJ; grind\n          simp [mem_iff, e] at hxJ hxj\n          obtain hjk | rfl | hjk := lt_trichotomy j k\n          . replace hjk : δ * ((j : ℝ) + 1) ≤ δ * (k : ℝ) := by rw [mul_le_mul_iff_of_pos_left hδpos]; norm_cast\n            linarith\n          . rfl\n          replace hjk : δ * ((k : ℝ) + 1) ≤ δ * (j : ℝ) := by rw [mul_le_mul_iff_of_pos_left hδpos]; norm_cast\n          linarith\n        contains J\n          hJ := by\n          simp at hJ; obtain rfl | ⟨j, hj, rfl⟩ := hJ <;> simp [subset_iff, e, I]\n          . linarith\n          apply Set.Ico_subset_Icc_self.trans (Set.Icc_subset_Icc _ _)\n          . simp; positivity\n          simp [hbeq]; gcongr; norm_cast }\n    have hup :=\n      calc\n        upper_integral f I ≤ ∑ J ∈ P.intervals, (sSup (f '' (J : Set ℝ))) * |J|ₗ := upper_integ_le_upper_sum hbound P\n        _ = ∑ j ∈ .range N, (sSup (f '' (Ico (a + δ * j) (a + δ * (j + 1))))) * |Ico (a + δ * j) (a + δ * (j + 1))|ₗ :=\n          by simp [P]; congr\n        _ ≤ ∑ j ∈ .range N, f (a + δ * (j + 1)) * δ :=\n          by\n          apply Finset.sum_le_sum; intro j hj\n          convert (mul_le_mul_right hδpos).mpr ?_\n          . simp [length]; ring_nf; simp [le_of_lt hδpos]\n          apply csSup_le\n          . simp; grind\n          intro y hy; simp at hy; obtain ⟨x, ⟨hx1, hx2⟩, rfl⟩ := hy\n          have : a + δ * (j + 1) ≤ b := by simp [hbeq]; gcongr; norm_cast; grind\n          have hδj : 0 ≤ δ * j := by positivity\n          have hδj1 : 0 ≤ δ * (j + 1) := by positivity\n          apply hf _ _ (by order) <;> simp [I, hδj1, this]; grind\n    have hdown :=\n      calc\n        lower_integral f I ≥ ∑ J ∈ P.intervals, (sInf (f '' (J : Set ℝ))) * |J|ₗ := lower_integ_ge_lower_sum hbound P\n        _ = ∑ j ∈ .range N, (sInf (f '' (Ico (a + δ * j) (a + δ * (j + 1))))) * |Ico (a + δ * j) (a + δ * (j + 1))|ₗ :=\n          by simp [P]; congr\n        _ ≥ ∑ j ∈ .range N, f (a + δ * j) * δ := by\n          apply Finset.sum_le_sum; intro j hj\n          convert (mul_le_mul_right hδpos).mpr ?_\n          . simp [length]; ring_nf; simp [le_of_lt hδpos]\n          apply le_csInf\n          . simp; grind\n          intro y hy; simp at hy; obtain ⟨x, ⟨hx1, hx2⟩, rfl⟩ := hy\n          have hajb' : a + δ * (j + 1) ≤ b := by simp [hbeq]; gcongr; norm_cast; grind\n          have hδj : 0 ≤ δ * j := by positivity\n          have hδj1 : 0 ≤ δ * (j + 1) := by positivity\n          apply_rules [hf] <;> simp [I, hδj] <;> grind\n    calc\n      _ ≤ ∑ j ∈ .range N, f (a + δ * (j + 1)) * δ - ∑ j ∈ .range N, f (a + δ * j) * δ := by linarith\n      _ = (f b - f a) * δ := by\n        rw [← Finset.sum_sub_distrib]\n        have := Finset.sum_range_sub (fun n ↦ f (a + δ * n) * δ) N\n        simp only [Nat.cast_add, Nat.cast_one] at this\n        convert this using 1; simp [hbeq]; ring\n      _ ≤ _ := by\n        have : 0 ≤ f b - f a := by simp; apply hf <;> simp [I, hab']\n        simp [mul_assoc, δ]; gcongr\n        rw [div_le_iff₀', mul_comm, mul_assoc]\n        nth_rewrite 1 [← mul_one (b - a)]\n        gcongr; rw [← div_le_iff₀']; linarith\n        all_goals positivity\n  refine ⟨hbound, ?_⟩\n  observe low_le_up : lower_integral f I ≤ upper_integral f I\n  linarith [nonneg_of_le_const_mul_eps this]","original":true},"params":[{"type":[783,786],"ref":[779,780],"id":[779,780],"bi":"implicit"},{"type":[783,786],"ref":[781,782],"id":[781,782],"bi":"implicit"},{"type":[791,802],"ref":[789,790],"id":[789,790],"bi":"implicit"},{"type":[809,831],"ref":[805,807],"id":[805,807],"bi":"default"}],"name":["Chapter11","integ_of_monotone"],"modifiers":null,"kind":"theorem","id":{"range":[760,777],"original":true}},{"value":{"range":[6180,6264],"original":true},"type":{"range":[6155,6179],"original":true},"signature":{"range":[6096,6179],"pp":" {a b : ℝ} {f : ℝ → ℝ} (hf : AntitoneOn f (Icc a b)) : IntegrableOn f (Icc a b)","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[6044,6264],"pp":"/-- Proposition 11.6.1 -/\ntheorem integ_of_antitone {a b : ℝ} {f : ℝ → ℝ} (hf : AntitoneOn f (Icc a b)) : IntegrableOn f (Icc a b) := by\n  rw [← neg_neg f]; apply (integ_of_monotone _).neg.1; convert hf.neg using 1","original":true},"params":[{"type":[6101,6104],"ref":[6097,6098],"id":[6097,6098],"bi":"implicit"},{"type":[6101,6104],"ref":[6099,6100],"id":[6099,6100],"bi":"implicit"},{"type":[6109,6120],"ref":[6107,6108],"id":[6107,6108],"bi":"implicit"},{"type":[6127,6149],"ref":[6123,6125],"id":[6123,6125],"bi":"default"}],"name":["Chapter11","integ_of_antitone"],"modifiers":null,"kind":"theorem","id":{"range":[6078,6095],"original":true}},{"value":{"range":[6436,6449],"original":true},"type":{"range":[6419,6435],"original":true},"signature":{"range":[6338,6435],"pp":" {I : BoundedInterval} {f : ℝ → ℝ} (hbound : BddOn f I) (hf : MonotoneOn f I) : IntegrableOn f I","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[6266,6449],"pp":"/-- Corollary 11.6.3 / Exercise 11.6.1 -/\ntheorem integ_of_bdd_monotone {I : BoundedInterval} {f : ℝ → ℝ} (hbound : BddOn f I) (hf : MonotoneOn f I) :\n    IntegrableOn f I := by sorry","original":true},"params":[{"type":[6341,6356],"ref":[6339,6340],"id":[6339,6340],"bi":"implicit"},{"type":[6361,6372],"ref":[6359,6360],"id":[6359,6360],"bi":"implicit"},{"type":[6383,6392],"ref":[6375,6381],"id":[6375,6381],"bi":"default"},{"type":[6401,6415],"ref":[6397,6399],"id":[6397,6399],"bi":"default"}],"name":["Chapter11","integ_of_bdd_monotone"],"modifiers":null,"kind":"theorem","id":{"range":[6316,6337],"original":true}},{"value":{"range":[6579,6592],"original":true},"type":{"range":[6562,6578],"original":true},"signature":{"range":[6481,6578],"pp":" {I : BoundedInterval} {f : ℝ → ℝ} (hbound : BddOn f I) (hf : AntitoneOn f I) : IntegrableOn f I","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[6451,6592],"pp":"theorem integ_of_bdd_antitone {I : BoundedInterval} {f : ℝ → ℝ} (hbound : BddOn f I) (hf : AntitoneOn f I) :\n    IntegrableOn f I := by sorry","original":true},"params":[{"type":[6484,6499],"ref":[6482,6483],"id":[6482,6483],"bi":"implicit"},{"type":[6504,6515],"ref":[6502,6503],"id":[6502,6503],"bi":"implicit"},{"type":[6526,6535],"ref":[6518,6524],"id":[6518,6524],"bi":"default"},{"type":[6544,6558],"ref":[6540,6542],"id":[6540,6542],"bi":"default"}],"name":["Chapter11","integ_of_bdd_antitone"],"modifiers":null,"kind":"theorem","id":{"range":[6459,6480],"original":true}},{"value":{"range":[6815,6828],"original":true},"type":{"range":[6756,6814],"original":true},"signature":{"range":[6675,6814],"pp":" {f : ℝ → ℝ} (hnon : ∀ x ≥ 0, f x ≥ 0) (hf : AntitoneOn f (.Ici 0)) : Summable f ↔ ∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[6594,6828],"pp":"/-- Proposition 11.6.4 (Integral test) -/\ntheorem summable_iff_integ_of_antitone {f : ℝ → ℝ} (hnon : ∀ x ≥ 0, f x ≥ 0) (hf : AntitoneOn f (.Ici 0)) :\n    Summable f ↔ ∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M := by\n  sorry\n    -- Exercise 11.6.2: Formulate a reasonable notion of a piecewise monotone function, and then\n    -- show that all bounded piecewise monotone functions are Riemann integrable.\n    ","original":true},"params":[{"type":[6678,6689],"ref":[6676,6677],"id":[6676,6677],"bi":"implicit"},{"type":[6698,6720],"ref":[6692,6696],"id":[6692,6696],"bi":"default"},{"type":[6729,6750],"ref":[6725,6727],"id":[6725,6727],"bi":"default"}],"name":["Chapter11","summable_iff_integ_of_antitone"],"modifiers":null,"kind":"theorem","id":{"range":[6644,6674],"original":true}},{"value":{"range":[7149,7162],"original":true},"type":{"range":[7035,7148],"original":true},"signature":{"range":[7033,7148],"pp":" : ∃ (f : ℝ → ℝ) (hnon : ∀ x ≥ 0, f x ≥ 0), Summable f ∧ ¬∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[7002,7162],"pp":"/-- Exercise 11.6.4 -/\nexample : ∃ (f : ℝ → ℝ) (hnon : ∀ x ≥ 0, f x ≥ 0), Summable f ∧ ¬∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M := by sorry","original":true},"params":[],"name":["Chapter11","_example"],"modifiers":null,"kind":"example","id":{"range":[7025,7032],"original":false}},{"value":{"range":[7288,7301],"original":true},"type":{"range":[7174,7287],"original":true},"signature":{"range":[7172,7287],"pp":" : ∃ (f : ℝ → ℝ) (hnon : ∀ x ≥ 0, f x ≥ 0), ¬Summable f ∧ ∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M","original":true},"scopeInfo":{"varDecls":[],"scopedOpenDecl":[["Chapter11","BoundedInterval"],["Chapter9"],["Chapter11"]],"openDecl":[{"simple":{"namespace":["Chapter11","BoundedInterval"],"except":[]}},{"simple":{"namespace":["Chapter9"],"except":[]}}],"omitVars":[],"levelNames":[],"includeVars":[],"currNamespace":["Chapter11"]},"ref":{"range":[7164,7301],"pp":"example : ∃ (f : ℝ → ℝ) (hnon : ∀ x ≥ 0, f x ≥ 0), ¬Summable f ∧ ∃ M, ∀ N ≥ 0, integ f (Icc 0 N) ≤ M := by sorry","original":true},"params":[],"name":["Chapter11","_example"],"modifiers":null,"kind":"example","id":{"range":[7164,7171],"original":false}}]
